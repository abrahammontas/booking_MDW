{% extends 'base.html.twig' %}

{% block body %}
<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript"	src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-growl/1.0.0/jquery.bootstrap-growl.min.js"></script>


<form action="{{ path('reservarPost') }}" method="POST">
	<div class="row">
		<div class="col-md-offset-2">
			<div class="col-md-5">
				<div class=" panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title">
							<legend>Datos de tu Reserva</legend>
						</h3>
					</div>
					<div class="panel-body">
						<div class="row">
							<div class="col-md-6">
								<div class="form-group">
									<label for="fecha_entrada">Entrada:</label> <input type="text"
										class="form-control" id="fecha_entrada" name="fecha_entrada"
										value="{{ fecha_entrada }}" readonly>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
									<label for="fecha_salida">Salida:</label> <input type="text"
										class="form-control" id="fecha_salida" name="fecha_salida"
										value="{{ fecha_salida }}" readonly>
								</div>
							</div>
						</div>

						<div class="row">
							<div class="col-md-6">
								<div class="form-group">
									<label for="hotel">Hotel:</label> <input type="text"
										class="form-control" id="hotel" name="hotel"
										value="{{ nombre_hotel }}" readonly> <input type="hidden"
										id="id_hotel" name="id_hotel" value="{{id_hotel}}">
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
									<label for="habitacion">Tipo Habitación:</label> <input type="text"
										class="form-control" id="habitacion" name="habitacion"
										value="{{tipo_habitacion}}" readonly> <input type="hidden"
										id="id_habitacion" name="id_habitacion"
										value="{{id_habitacion}}">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="form-group">
									<label for="direccion">Dirección:</label> <input type="text"
										class="form-control" id="direccion" name="direccion"
										value="{{ direccion_hotel }}" readonly>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
									<label for="cod_postal">Código Postal:</label> <input
										type="text" class="form-control" id="cod_postal"
										name="cod_postal" value="{{ codPostal_hotel }}" readonly>
								</div>
							</div>
						</div>
						<div class="row">
						    <div class="col-md-4">
                                <div class="form-group">
                                    <label for="num_habitacion">No.Habitación:</label> <input type="text"
                                        class="form-control" id="num_habitacion" name="num_habitacion"
                                        value="{{num_habitacion}}" readonly> 
                                </div>
                            </div>
							<div class="col-md-4">
								<div class="form-group">
									<label for="horas">Horas:</label><input type="text"
										class="form-control" id="horas" name="horas"
										value="{{ horas }}" readonly>
								</div>
							</div>
							<div class="col-md-4">
								<div class="form-group">
									<label for="precio">Precio:</label> &euro;<input type="text"
										class="form-control" id="precio" name="precio"
										value="{{ precio }}" readonly>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-5">
				<div class="panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title">
							<legend>Tus Datos</legend>
						</h3>
					</div>
					<div class="panel-body">
						<div class="row">
							<div class="col-md-6">
								<div class="form-group">
									<label for="email_cliente">Email:</label> <input type="text"
										class="form-control" id="email_cliente"
										onblur="validar_email(this.value)" name="email_cliente"
										placeholder="Ingrese Email" required> <input
										type="hidden" id="id_cliente" name="id_cliente">
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
									<label for="nombre_cliente">Nombre:</label> <input type="text"
										class="form-control" id="nombre_cliente" name="nombre_cliente"
										placeholder="Ingrese Nombre" required>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="form-group">
									<label for="apellidos_cliente">Apellidos:</label> <input
										type="text" class="form-control" id="apellidos_cliente"
										name="apellidos_cliente" placeholder="Ingrese Apellidos"
										required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
									<label for="telefono_cliente">Teléfono:</label> <input
										type="text" class="form-control" id="telefono_cliente"
										name="telefono_cliente" placeholder="Ingrese Teléfono"
										required>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="form-group">
									<label for="nif_cliente">NIF:</label> <input type="text"
										class="form-control" id="nif_cliente" name="nif_cliente"
										placeholder="Ingrese NIF" required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group">
									<label for="direccion_cliente">Dirección:</label> <input
										type="text" class="form-control" id="direccion_cliente"
										name="direccion_cliente" placeholder="Ingrese Dirección"
										required>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="form-group">
									<label for="codPostal_cliente">Código Postal:</label> <input
										type="text" class="form-control" id="codPostal_cliente"
										name="codPostal_cliente" placeholder="Ingrese Código Postal"
										required>
								</div>
							</div>
							<div class="col-md-6">
								<div class="form-group" id="cont_contrasenia">
									<label for="contrasenia_cliente">Contraseña:</label> <input
										type="password" class="form-control" id="contrasenia_cliente"
										name="contrasenia_cliente" placeholder="Ingrese Contraseña">
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div><br/>
	<div class="row">
		<div class="col-md-offset-5">
			<button type="submit" class="btn btn-default">Reservar</button>&nbsp;&nbsp;&nbsp;&nbsp;
			<a class="btn btn-default" href="{{ path('homepage')}}">Cancelar</a>
   
		</div>
	</div>
</form>


<script>
	$(document).ready(function() {

		$("#cont_contrasenia").show();
		$("#id_cliente").val("");
		$("#email_cliente").val("");
		$("#nombre_cliente").val("");
		$("#apellidos_cliente").val("");
		$("#telefono_cliente").val("");
		$("#nif_cliente").val("");
		$("#direccion_cliente").val("");
		$("#codPostal_cliente").val("");
		$("#contrasenia_cliente").val("");

	}());

	function validar_email(email) {
		var urlGetCategories = "http://localhost:8000/cliente/" + email;
		$
				.get(urlGetCategories, {})
				.then(
						function(respuesta) {

							var data = JSON.parse(respuesta);
							if (data != null) {
								$("#cont_contrasenia").hide();
								$("#id_cliente").val(data['id']);
								$("#nombre_cliente").val(data['nombre']);
								$('#nombre_cliente').attr('readonly', true);
								$("#apellidos_cliente").val(data['apellidos']);
								$('#apellidos_cliente').attr('readonly', true);
								$("#telefono_cliente").val(data['telefono']);
								$('#telefono_cliente').attr('readonly', true);
								$("#nif_cliente").val(data['nif']);
								$('#nif_cliente').attr('readonly', true);
								$("#direccion_cliente").val(data['direccion']);
								$('#direccion_cliente').attr('readonly', true);
								$("#codPostal_cliente").val(data['cod_postal']);
								$('#codPostal_cliente').attr('readonly', true);

								$.bootstrapGrowl('Ya te encuestras registrado, Puedes Reservar Ahora!',{
									type : 'success',
									delay : 3000,
									});

							} else {
								$("#cont_contrasenia").show();
								$("#id_cliente").val("");
								$('#nombre_cliente').attr('readonly', false);
								$('#apellidos_cliente').attr('readonly', false);
								$('#telefono_cliente').attr('readonly', false);
								$('#nif_cliente').attr('readonly', false);
								$('#direccion_cliente').attr('readonly', false);
								$('#codPostal_cliente').attr('readonly', false);

							}
						});

	}
</script>
{% endblock %}

